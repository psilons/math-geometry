%! Package = PACKAGE_NAME
%! Author = Wonderland
%! Date = 10/23/2021

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{exercise}[2021/10/23 Exercise's Package]

\RequirePackage{fancyhdr}

\RequirePackage{tcolorbox}
\tcbuselibrary{most}

% 调色板
\RequirePackage{xcolor-material}

\newcommand{\exerheader}[4]{
    % https://tex.stackexchange.com/questions/69950/fancyhdr-color-and-width-of-line
    \fancypagestyle{pageheader}{
        \fancyhf{}% Clear all headers/footers

        \fancyhead[L]{\raisebox{-.5\baselineskip}[0pt][0pt]{#1}}% Header Centred
        \fancyhead[C]{\raisebox{-.5\baselineskip}[0pt][0pt]{\textbf{\Large {#2}}}}% Header Centred
        \fancyhead[R]{\raisebox{-.5\baselineskip}[0pt][0pt]{#3}}% Header Centred

        \renewcommand{\headrulewidth}{2pt}% 2pt header rule
        \renewcommand{\headrule}{\hbox to\headwidth{%
                \color{#4}\leaders\hrule height \headrulewidth\hfill}}

        \fancyfoot[C]{Page\hspace{1mm}\thepage}% Footer Centred
        \renewcommand{\footrulewidth}{0pt}% No footer rule
    }

    \pagestyle{pageheader}
}

% define 6 colors
\definecolor{ctbRedDark}{RGB}{155, 28, 49} % Royal Red
\definecolor{ctbRedLight}{RGB}{255, 242, 242} % red!5
\definecolor{ctbGreenDark}{RGB}{19, 160, 7} % Royal Green modified
\definecolor{ctbGreenLight}{RGB}{242, 255, 242} % green!5
\definecolor{ctbBlueDark}{RGB}{65, 105, 225} % Royal Blue
\definecolor{ctbBlueLight}{RGB}{242, 242, 255} % blue!5

\definecolor{ctbHoneyDark}{RGB}{244,143,35} %
\definecolor{ctbHoneyLight}{RGB}{255,253,230} %
\definecolor{ctbPinkDark}{RGB}{217,2,125} %
\definecolor{ctbPinkLight}{RGB}{255,230,242} %
\definecolor{ctbPurpleDark}{RGB}{165,80,236} %
\definecolor{ctbPurpleLight}{RGB}{238,226,242} %

%--------------------------------------------------------------------------------------------------
% Colored Text Blocks
% Two dimensional shortcuts, title names and colors.
%--------------------------------------------------------------------------------------------------
% Stripped title. Leave title open to users to overwrite, no number sequence.
% This is base function, shouldn't be called by users
\newtcbtheorem{cbstrip}{Dummy}{%
    %theorem name,%
    %colback=green!5,%
    %colframe=green!35!black,%
    toptitle=3pt, bottomtitle=3pt, left=5pt, right=5pt,
    %boxsep=5pt,
    fonttitle=\sffamily,
    title after break={Problem  -- \raggedleft Continued}%
}{cbstrip}

% pass in title, such as Problem, Fermats Last Theorem
\newenvironment{cbred}[1]
    {\begin{cbstrip}[adjusted title=#1, colframe=ctbRedDark,colback=ctbRedLight]{}{}}
    {\end{cbstrip}}

\newenvironment{cbgreen}[1]
    {\begin{cbstrip}[adjusted title=#1, colframe=ctbGreenDark,colback=ctbGreenLight,]{}{}}
    {\end{cbstrip}}

\newenvironment{cbblue}[1]
    {\begin{cbstrip}[adjusted title=#1, colframe=ctbBlueDark,colback=ctbBlueLight,]{}{}}
    {\end{cbstrip}}

\newenvironment{cbhoney}[1]
    {\begin{cbstrip}[adjusted title=#1, colframe=ctbHoneyDark,colback=ctbHoneyLight,]{}{}}
    {\end{cbstrip}}

\newenvironment{cbpink}[1]
    {\begin{cbstrip}[adjusted title=#1, colframe=ctbPinkDark,colback=ctbPinkLight,]{}{}}
    {\end{cbstrip}}

\newenvironment{cbpurple}[1]
    {\begin{cbstrip}[adjusted title=#1, colframe=ctbPurpleDark,colback=ctbPurpleLight,]{}{}}
    {\end{cbstrip}}

%--------------------------------------------------------------------------------------------------
% Stripped title. Hardcode title to "Problem".
%--------------------------------------------------------------------------------------------------
\newtcbtheorem{cbstripproblem}{Problem}{%
    toptitle=3pt, bottomtitle=3pt, left=5pt, right=5pt,
    fonttitle=\sffamily,
    title after break={Problem  -- \raggedleft Continued}%
}{cbsprob}

\newenvironment{cbredproblem}[2]
    {\begin{cbstripproblem}[colframe=ctbRedDark,colback=ctbRedLight]{#1}{#2}}
    {\end{cbstripproblem}}

\newenvironment{cbgreenproblem}[2]
    {\begin{cbstripproblem}[colframe=ctbGreenDark,colback=ctbGreenLight]{#1}{#2}}
    {\end{cbstripproblem}}

\newenvironment{cbblueproblem}[2]
    {\begin{cbstripproblem}[colframe=ctbBlueDark,colback=ctbBlueLight]{#1}{#2}}
    {\end{cbstripproblem}}

\newenvironment{cbhoneyproblem}[2]
    {\begin{cbstripproblem}[colframe=ctbHoneyDark,colback=ctbHoneyLight]{#1}{#2}}
    {\end{cbstripproblem}}

\newenvironment{cbpinkproblem}[2]
    {\begin{cbstripproblem}[colframe=ctbPinkDark,colback=ctbPinkLight]{#1}{#2}}
    {\end{cbstripproblem}}

\newenvironment{cbpurpleproblem}[2]
    {\begin{cbstripproblem}[colframe=ctbPurpleDark,colback=ctbPurpleLight]{#1}{#2}}
    {\end{cbstripproblem}}

%--------------------------------------------------------------------------------------------------
% Beveled Titles
%--------------------------------------------------------------------------------------------------
% User supplied title, no number sequence
\newtcbtheorem{cbbevel}{Dummy}{
    enhanced, % without this, the title box won't show up
    %fonttitle=\bfseries,
    boxrule=0.1mm,
    %before upper={\parindent2em}, % no indent
    %colback=MaterialGreen50,
%   colframe=MaterialGreen,
    attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
%   boxed title style={colback=MaterialGreen}
}{cbbevel}

% pass in title, such as Problem, Fermats Last Theorem
\newenvironment{cbbred}[1]
    {\begin{cbbevel}[adjusted title=#1, colback=ctbRedLight,
        boxed title style={colback=ctbRedDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{}{}}
    {\end{cbbevel}}

\newenvironment{cbbgreen}[1]
    {\begin{cbbevel}[adjusted title=#1, colback=ctbGreenLight,
        boxed title style={colback=ctbGreenDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{}{}}
    {\end{cbbevel}}

\newenvironment{cbbblue}[1]
    {\begin{cbbevel}[adjusted title=#1, colback=ctbBlueLight,
        boxed title style={colback=ctbBlueDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{}{}}
    {\end{cbbevel}}

\newenvironment{cbbhoney}[1]
    {\begin{cbbevel}[adjusted title=#1, colback=ctbHoneyLight,
        boxed title style={colback=ctbHoneyDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{}{}}
    {\end{cbbevel}}

\newenvironment{cbbpink}[1]
    {\begin{cbbevel}[adjusted title=#1, colback=ctbPinkLight,
        boxed title style={colback=ctbPinkDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{}{}}
    {\end{cbbevel}}

\newenvironment{cbbpurple}[1]
    {\begin{cbbevel}[adjusted title=#1, colback=ctbPurpleLight,
        boxed title style={colback=ctbPurpleDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{}{}}
    {\end{cbbevel}}

%--------------------------------------------------------------------------------------------------
% Beveled, hardcode title prefix to "Problem", has number sequence
%--------------------------------------------------------------------------------------------------
%
\newtcbtheorem{cbbevelproblem}{Problem}{
    enhanced,
    boxrule=0.1mm,
    %toptitle=3pt, bottomtitle=3pt, left=5pt, right=5pt,
    attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
}{cbbprob}

\newenvironment{cbbredproblem}[2]
    {\begin{cbbevelproblem}[colback=ctbRedLight,
        boxed title style={colback=ctbRedDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{#1}{#2}}
    {\end{cbbevelproblem}}

\newenvironment{cbbgreenproblem}[2]
    {\begin{cbbevelproblem}[colback=ctbGreenLight,
        boxed title style={colback=ctbGreenDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{#1}{#2}}
    {\end{cbbevelproblem}}

\newenvironment{cbbblueproblem}[2]
    {\begin{cbbevelproblem}[colback=ctbBlueLight,
        boxed title style={colback=ctbBlueDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{#1}{#2}}
    {\end{cbbevelproblem}}

\newenvironment{cbbhoneyproblem}[2]
    {\begin{cbbevelproblem}[colback=ctbHoneyLight,
        boxed title style={colback=ctbHoneyDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{#1}{#2}}
    {\end{cbbevelproblem}}

\newenvironment{cbbpinkproblem}[2]
    {\begin{cbbevelproblem}[colback=ctbPinkLight,
        boxed title style={colback=ctbPinkDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{#1}{#2}}
    {\end{cbbevelproblem}}

\newenvironment{cbbpurpleproblem}[2]
    {\begin{cbbevelproblem}[colback=ctbPurpleLight,
        boxed title style={colback=ctbPurpleDark, boxrule=0mm,
                           top=3pt, bottom=3pt, left=4pt, right=4pt}]{#1}{#2}}
    {\end{cbbevelproblem}}

%--------------------------------------------------------------------------------------------------
% Vertical Bar
%--------------------------------------------------------------------------------------------------
%
\newtcolorbox{cbbarbox}[1]{
  skin=empty,
  top=0pt,
  bottom=0pt,
  toprule=0pt,
  bottomrule=0pt,
  leftrule=0pt,
  rightrule=0pt,
  borderline west={2pt}{0pt}{#1},
}

% pass in title, such as Problem, Fermats Last Theorem
\newenvironment{cbbar}[2]
    {\begin{cbbarbox}{#2} \textcolor{#2}{\textbf{#1:}}}
    {\end{cbbarbox}}






\newtcbtheorem[number within=section]{theorem}{Theorem}{
  enhanced, % without this, the title box won't show up
  fonttitle=\bfseries,
  boxrule=0.1mm,
  %before upper={\parindent2em}, % no indent
  colback=MaterialGreen50,
  colframe=MaterialGreen,
  attach boxed title to top left={xshift=12pt, yshift*=-\tcboxedtitleheight/2},
  boxed title style={colback=MaterialGreen}
}{theorem}

\newenvironment{theoremgreen}[2]{
    \begin{theorem}[adjusted title=#1]{}{#2}
    \textbf{Theorem \thetcbcounter.}
    }{\end{theorem}
}

%\newtcbtheorem[auto counter]{cbstrip}{Problem}{%
%    %theorem name,%
%    colback=green!5,%
%    colframe=green!35!black,%
%    top=5pt,
%    bottom=5pt,
%    %boxsep=5pt,
%    left=5pt,
%    fonttitle=\sffamily,
%    title after break={Problem  -- \raggedleft Continued}%
%}{cbstrip}
%
%\newenvironment{theoremblue}[2]{
%    \begin{cbstrip}[adjusted title=#1, colback=blue!5,]{}{#2}
%    %\textbf{Theorem \thetcbcounter.}
%    }{\end{cbstrip}
%}


\newtcbtheorem{problem}{Problem}{% https://tex.stackexchange.com/questions/198820/create-newshadetheorem-without-numbering
    theorem name,%
    colback=green!5,%
    colframe=green!35!black,%
    fonttitle=\bfseries,title after break={Problem  -- \raggedleft Continued}%
}{problem}

\newtcbtheorem[number within=chapter]{Theorem}{}{
        enhanced,
        %sharp corners,
        attach boxed title to top left={
            xshift=12pt,
            yshift=-\tcboxedtitleheight/2,
            %yshifttext=-1mm
        },
        top=1.5em,
        colback=white,
        colframe=blue!75!black,
        fonttitle=\bfseries,
        boxed title style={
            %sharp corners,
            %size=small,
            colback=blue!75!black,
            %colframe=blue!75!black,
        }
    }{thm}


\newenvironment{myTheorem}[2]{
    \begin{Theorem}[adjusted title=#1]{}{#2}
    \textbf{Theorem \thetcbcounter.}
    }{\end{Theorem}
}
